
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Dudás Ákos">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>Exercise 3: Creating a transformation - BMEVIAUMB00 and BMEVIAUMB09 Business Intelligence Laboratory</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../extra-material-theme.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="red">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercise-3-creating-a-transformation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BMEVIAUMB00 and BMEVIAUMB09 Business Intelligence Laboratory" class="md-header__button md-logo" aria-label="BMEVIAUMB00 and BMEVIAUMB09 Business Intelligence Laboratory" data-md-component="logo">
      
  <img src="../../images/logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUMB00 and BMEVIAUMB09 Business Intelligence Laboratory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exercise 3: Creating a transformation
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to dark theme"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark theme" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent=""  aria-label="Switch to light theme"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light theme" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/bi-labor/es-mssql/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bi-labor/es-mssql
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        BI lab
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../elasticsearch/" class="md-tabs__link">
        Elasticsearch
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Pentaho
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../mssql/" class="md-tabs__link">
        MSSQL
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BMEVIAUMB00 and BMEVIAUMB09 Business Intelligence Laboratory" class="md-nav__button md-logo" aria-label="BMEVIAUMB00 and BMEVIAUMB09 Business Intelligence Laboratory" data-md-component="logo">
      
  <img src="../../images/logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUMB00 and BMEVIAUMB09 Business Intelligence Laboratory
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/bi-labor/es-mssql/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bi-labor/es-mssql
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          BI lab
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="BI lab" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          BI lab
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Business Intelligence Laboratory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../GitHub/" class="md-nav__link">
        Submitting your work (GitHub)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../GitHub-Actions/" class="md-nav__link">
        GitHub Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../GitHub-credentials/" class="md-nav__link">
        GitHub credentials in university labs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Elasticsearch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Elasticsearch" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Elasticsearch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/" class="md-nav__link">
        Elasticsearch laboratory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise1/" class="md-nav__link">
        Exercise 1: Get the starter solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise2/" class="md-nav__link">
        Exercise 2: Initializing Elasticsearch and Kibana
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise3/" class="md-nav__link">
        Exercise 3: Initializing Elasticsearch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise4/" class="md-nav__link">
        Exercise 4: Elasticsearch queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise5/" class="md-nav__link">
        Exercise 5: Kibana visualizations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise6/" class="md-nav__link">
        Exercise 6: Elasticsearch queries — practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise7/" class="md-nav__link">
        Exercise 7: Kibana visualizations — practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/bme-cloud-vm-usage/" class="md-nav__link">
        Using BME Cloud
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Pentaho
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Pentaho" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Pentaho
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Pentaho laboratory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise1/" class="md-nav__link">
        Exercise 1: Get the starter solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise2/" class="md-nav__link">
        Exercise 2: Preparing the environment
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Exercise 3: Creating a transformation
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise4/" class="md-nav__link">
        Exercise 4: Creating a job to run a transformation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise5/" class="md-nav__link">
        Exercise 5: Creating a report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise6/" class="md-nav__link">
        Exercise 6: Data Integration — Transformation practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise7/" class="md-nav__link">
        Exercise 7: Data Integration — Job practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise8/" class="md-nav__link">
        Exercise 8: Report Designer — practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bme-cloud-vm-usage/" class="md-nav__link">
        Using BME Cloud
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          MSSQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MSSQL" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          MSSQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/" class="md-nav__link">
        Microsoft SQL Server Business Intelligence
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/exercise1/" class="md-nav__link">
        Exercise 1: Get the starter solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/exercise2/" class="md-nav__link">
        Exercise 2: Create database and table for users data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/exercise3/" class="md-nav__link">
        Exercise 3: Import the users dataset using Integration Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/exercise4/" class="md-nav__link">
        Exercise 4: Report about users
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/exercise5/" class="md-nav__link">
        Exercise 5: Import the books and ratings datasets using Integration Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/exercise6/" class="md-nav__link">
        Exercise 6: Create a report listing the highest rated books
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/bi-software-intro/" class="md-nav__link">
        Using MSSQL BI tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mssql/bme-cloud-vm-usage/" class="md-nav__link">
        Using BME Cloud
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/bi-labor/es-mssql/edit/master/docs/pentaho/exercise3.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="exercise-3-creating-a-transformation">Exercise 3: Creating a transformation<a class="headerlink" href="#exercise-3-creating-a-transformation" title="Permanent link">&para;</a></h1>
<p>We will be using the files containing the results of previous final exams, to create new information. This information will be used for decision making, statistics, etc. In the first task, we will create a transformation, which takes the files, parses them, creates yearly and other statistics.</p>
<ol>
<li>
<p>If you have started the Pentaho Data Integration correctly, the following screen will appear:</p>
<p><img alt="Pentaho Data Integration" src="../images/pdi-transformation01.png" /></p>
</li>
<li>
<p>Create a new transformation, by choosing File -&gt; New -&gt; Transformation. Save this file named <code>ex3-transformation1.ktr</code>, in the
working directory.</p>
</li>
<li>
<p>Using the search bar on the left panel, place a <em>Get file names</em> node on the screen.</p>
<p><img alt="Get file names search" src="../images/pdi-transformation02.png" /></p>
</li>
<li>
<p>Double click on the placed node to open the context menu:</p>
<p><img alt="Get file names" src="../images/pdi-transformation03.png" /></p>
<ul>
<li>In the panel above the table, we can define a file or folder to use. When done, pressing the Add button will put it in the table.</li>
<li>The browse button opens a file picker, if you want to pick a directory, you first choose a file, then delete the last part of the path manually. Choose C:\Pentaho\data\ZV\</li>
<li>Use the regular expresion input, to limit the search for csv files. Use the following pattern: .*csv To make sure you have correctly set up the node, press the Preview Rows button, you should see something like this</li>
</ul>
<p><img alt="Get file names list" src="../images/pdi-transformation04.png" /></p>
</li>
<li>
<p>Place a <em>CSV File input</em> node on the transformation. To connect it with our Get File Names node, hover over the former and select the rightmost box.</p>
<p><img alt="Hover" src="../images/pdi-transformation05.png" /></p>
<p>The connection should look like this:</p>
<p><img alt="Connection" src="../images/pdi-transformation06.png" /></p>
<div class="admonition warning">
<p class="admonition-title">Be careful!</p>
<p>If you click on the arrow, it will turn grey, indicating the connection is disabled! You should never see this:</p>
</div>
<p><img alt="Connection disbaled" src="../images/pdi-transformation07.png" /></p>
</li>
<li>
<p>Double click on the “CSV File Input” node and set the following:</p>
<ul>
<li>The filename field -&gt; filename</li>
<li>Include filename field -&gt; check (we will use it to parse the date)</li>
<li>Delimiter -&gt; ;</li>
<li>Enclosure -&gt; delete the content</li>
<li>Lazy conversion -&gt; uncheck</li>
<li>Add the columns from the file (Identifier - Integer, Neptun code - String, Exam score - Integer, Application score - Integer, Grade - Number)</li>
</ul>
<p><img alt="CSV input" src="../images/pdi-transformation08.png" /></p>
<p>Running the whole transformation now (by pressing the play button), should lead to both our nodes finishing successfully. When clicking on the <em>Preview data</em> tab on the bottom, we should see the following:</p>
<p><img alt="CSV preview" src="../images/pdi-transformation09.png" /></p>
</li>
<li>
<p>We want to include the date of the exam for each data entry. To do this we have to parse this information from the filename field. The first step is to cut the string to the necessary length, by using a String cut node. Place it and connect it to the <em>CSV File input</em>. Double clicking on it should bring up the following screen:</p>
<p><img alt="String cut" src="../images/pdi-transformation10.png" /></p>
<ul>
<li>Set the <em>In stream field</em> to filename,</li>
<li>Set the <em>Out stream field</em> to Date, this will make the node put its output (the cut stirng) in a new field.</li>
<li>Set the <em>Cut from</em> and <em>Cut to</em>, to cut the filename from the absolute path (19 and 25 if you use C:\Pentaho as the working directory)</li>
</ul>
</li>
<li>
<p>Place a <em>Replace in string</em> node and connect it to the previous node. Double click and set it up to replace the _ (underscore) with a / (slash) in the field Date:</p>
<p><img alt="Replace in string" src="../images/pdi-transformation11.png" /></p>
<p>The transformation looks like the following now:</p>
<p><img alt="Transformation1" src="../images/pdi-transformation12.png" /></p>
<p>If everything was done correctly, you should see the following output in the Preview data.</p>
<p><img alt="Preview data" src="../images/pdi-transformation13.png" /></p>
</li>
<li>
<p>Place a <em>Filter rows</em> node, we will use this to filter out the rows where the Grade (Osztályzat) is invalid. The Filter node has a hierarchical Boolean expression builder. Set it up as the following:</p>
<p><img alt="Filter rows" src="../images/pdi-transformation14.png" /></p>
</li>
<li>
<p>Place a <em>Data validator</em> node. We will use this to validate the proper formatting of the Neptun code. In order to do this, double click on the node, and add a new validation rule by clicking on the New validation button.</p>
<p><img alt="Data validator" src="../images/pdi-transformation15.png" /></p>
<ul>
<li>Check the <em>Report all errors, not only the first</em></li>
<li>Select Neptun code in the <em>Name of the field to validate</em></li>
<li>Put this regular expression in the <em>Regular expression expected to match</em> cell: [A-Z0-9]{6}</li>
</ul>
<p>After running the transformation, we should see that our validator has found an error:</p>
<p><img alt="Transformation2" src="../images/pdi-transformation16.png" /></p>
</li>
<li>
<p>To proceed, we have to handle this error. The easiest way to do this, is to append a <em>Text file output</em> node to the <em>Error handling of the step</em> output of the <em>Data Validator</em>.</p>
<p><img alt="Transformation3" src="../images/pdi-transformation17.png" /></p>
<p>In the <em>Text File Output</em>, we define an output file, for example C:\Pentaho\result\invalid_neptun.txt</p>
<p><img alt="Text file output" src="../images/pdi-transformation18.png" /></p>
<p>If done correctly, the transformation should no longer fail, and the output file should contain the invalid rows:</p>
<p><img alt="Invalid neptun" src="../images/pdi-transformation19.png" /></p>
</li>
<li>
<p>Next, we place a <em>Sort Rows</em> node. This will be used to presort the data for our <em>Group by</em> node, which only works on data sorted by the grouping key. After placing and connecting the node, set the <em>Fieldname</em> to Date, and leave the other cells on default values. </p>
<div class="admonition warning">
<p class="admonition-title">IMPORTANT</p>
<p>If Pentaho asks whether to copy or distribute the data as the output of this step choose copy.</p>
</div>
<p><img alt="Sort rows" src="../images/pdi-transformation20.png" /></p>
</li>
<li>
<p>Place a <em>Group By</em> node and connect it to the <em>Sort Rows</em> node.</p>
<p><img alt="Transformation4" src="../images/pdi-transformation21.png" /></p>
<p>Set it up as the following:</p>
<ul>
<li>Group field (the key which will be used to create the groups): Date</li>
<li>Aggregates (the functions ran on the groups)<ul>
<li><em>Name</em>: Number of students, <em>Subject</em>: -, <em>Type</em>: Number of rows (without field argument)</li>
<li><em>Name</em>: Average grade, <em>Subject</em>: Grade, <em>Type</em>: Average (Mean)</li>
</ul>
</li>
</ul>
<p><img alt="Group by" src="../images/pdi-transformation22.png" /></p>
<p>If everything is working correctly, you should see the aggregated results at the Preview data tab of the Group by.</p>
</li>
<li>
<p>In this next part, we will be creating a report on those students, who took the final exam more than once. For this, we will be creating a new path in the transformation. Place a <em>Filter rows</em> node after our previously placed <em>Data Validator</em>. This filter will filter out those rows, which doesn’t contain a Neptun code. This is necessary, because Neptun is the only way to identify a student between multiple exams. The node is configured as follows:</p>
<p><img alt="Filter rows" src="../images/pdi-transformation23.png" /></p>
</li>
<li>
<p>Next we place a <em>Sort rows</em> node, which will presort the date for our uniqueness checker (in much the same way as for the <em>Group by</em>). Configure this sorting step as the following:</p>
<div class="admonition note">
<p>Write your NEPTUN code after the step name!</p>
</div>
<p><img alt="Sort rows" src="../images/pdi-transformation24.png" /></p>
</li>
<li>
<p>Place a <em>Unique rows</em> node after the sort and set it up as the following (note that <em>Redirect duplicate row</em> is checked).</p>
<p><img alt="Unique rows" src="../images/pdi-transformation25.png" /></p>
</li>
<li>
<p>Finally place a <em>Microsoft Excel Output</em> at the Error handling of the <em>Unique rows</em>. This will place the duplicate rows (students who took more than one final exam) in this Excel sheet. Set it up to save the file C:\Pentaho\result\multiple_exams.xls</p>
<p><img alt="Excel output" src="../images/pdi-transformation26.png" /></p>
<p>The final transformation should look like this:</p>
<p><img alt="Final transformation" src="../images/pdi-transformation27.png" /></p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning!</p>
<p>Note, that opening the file will cause Excel to lock it, therefore any subsequent runs will fail, while the file is open!</p>
</div>
<div class="admonition example">
<p class="admonition-title">SUBMISSION</p>
<p>Save the final transformation as <code>ex3-transformation1.ktr</code></p>
<p>Create a screenshot of the executed transformation flow and save it as <code>ex3-transformation1-flow.png</code>. Make sure that all the nodes including your Neptun code are visible on this screenshot.</p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../exercise2/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Exercise 2: Preparing the environment" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Exercise 2: Preparing the environment
            </div>
          </div>
        </a>
      
      
        
        <a href="../exercise4/" class="md-footer__link md-footer__link--next" aria-label="Next: Exercise 4: Creating a job to run a transformation" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Exercise 4: Creating a job to run a transformation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; BME VIK AUT
          </div>
        
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>