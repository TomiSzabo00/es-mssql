
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Dudás Ákos">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>Exercise 3: Import the users dataset using Integration Services - BMEVIAUMB00 Business Intelligence Laboratory</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../extra-material-theme.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="red">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercise-3-import-the-users-dataset-using-integration-services" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BMEVIAUMB00 Business Intelligence Laboratory" class="md-header__button md-logo" aria-label="BMEVIAUMB00 Business Intelligence Laboratory" data-md-component="logo">
      
  <img src="../../images/logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUMB00 Business Intelligence Laboratory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exercise 3: Import the users dataset using Integration Services
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to dark theme"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark theme" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent=""  aria-label="Switch to light theme"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light theme" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/bi-labor/es-mssql/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bi-labor/es-mssql
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        BI lab
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../elasticsearch/" class="md-tabs__link">
        Elasticsearch
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        MSSQL
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BMEVIAUMB00 Business Intelligence Laboratory" class="md-nav__button md-logo" aria-label="BMEVIAUMB00 Business Intelligence Laboratory" data-md-component="logo">
      
  <img src="../../images/logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUMB00 Business Intelligence Laboratory
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/bi-labor/es-mssql/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bi-labor/es-mssql
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          BI lab
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="BI lab" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          BI lab
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Elasticsearch & MSSQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../GitHub/" class="md-nav__link">
        Submitting your work (GitHub)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../GitHub-Actions/" class="md-nav__link">
        GitHub Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../GitHub-credentials/" class="md-nav__link">
        GitHub credentials in university labs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Elasticsearch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Elasticsearch" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Elasticsearch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/" class="md-nav__link">
        Elasticsearch laboratory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise1/" class="md-nav__link">
        Exercise 1: Get the starter solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise2/" class="md-nav__link">
        Exercise 2: Initializing Elasticsearch and Kibana
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise3/" class="md-nav__link">
        Exercise 3: Initializing Elasticsearch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise4/" class="md-nav__link">
        Exercise 4: Elasticsearch queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise5/" class="md-nav__link">
        Exercise 5: Kibana visualizations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise6/" class="md-nav__link">
        Exercise 6: Elasticsearch queries — practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../elasticsearch/exercise7/" class="md-nav__link">
        Exercise 7: Kibana visualizations — practice
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          MSSQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MSSQL" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          MSSQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Microsoft SQL Server Business Intelligence
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise1/" class="md-nav__link">
        Exercise 1: Get the starter solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise2/" class="md-nav__link">
        Exercise 2: Create database and table for users data
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Exercise 3: Import the users dataset using Integration Services
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise4/" class="md-nav__link">
        Exercise 4: Report about users
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise5/" class="md-nav__link">
        Exercise 5: Import the books and ratings datasets using Integration Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise6/" class="md-nav__link">
        Exercise 6: Create a report listing the highest rated books
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bi-software-intro/" class="md-nav__link">
        Using MSSQL BI tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bme-cloud-vm-usage/" class="md-nav__link">
        Using BME Cloud
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/bi-labor/es-mssql/edit/master/docs/mssql/exercise3.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="exercise-3-import-the-users-dataset-using-integration-services">Exercise 3: Import the users dataset using Integration Services<a class="headerlink" href="#exercise-3-import-the-users-dataset-using-integration-services" title="Permanent link">&para;</a></h1>
<p>Extend the provided Integration Services project <code>ex3.sln</code> by modifying the project contents in place. You can find this solution in the root of the checked out git repository.</p>
<ol>
<li>
<p>Open the solution with Visual Studio, then open <code>Package.dtsx</code> from <em>Solution explorer</em>.</p>
<p><img alt="Solution explorer of the project" src="../images/is-solution-explorer.png" /></p>
</li>
<li>
<p>Find the <em>SSIS Toolbox</em>; you will need to use this window in the following tasks.</p>
<div class="admonition note">
<p>If you cannot see this toolbox window after opening <code>Package.dtsx</code>, look for the <em>Extensions &gt; SSIS &gt; SSIS Toolbox</em> menu.</p>
</div>
</li>
<li>
<p>Add a new <em>SQL Task</em> to the <em>Control flow</em> that erases any content from the target database table. You will likely need to run the ETL process multiple times, but the data should only be imported once, hence the initial cleanup task.</p>
<ul>
<li>Drag the <em>SQL Task</em> from the toolbox.</li>
<li>Double click to open the details.</li>
<li>Specify the connection settings:<ul>
<li>Use <code>ADO.NET</code> connection type.</li>
<li>Add a new connection using the dropdown. This will open a new dialog, where you need to click on the <em>New</em> button again to add a new connection. Use the same connection settings (address and authentication) as before. When you configured the connection properties, make sure to press the <em>Test</em> button to verify the settings.</li>
</ul>
</li>
<li>Specify a <code>truncate table &lt;tablename&gt;</code> <a href="https://docs.microsoft.com/en-us/sql/t-sql/statements/truncate-table-transact-sql?view=sql-server-2017">sql statement</a> to prune the table contents. The sql command should <em>NOT</em> contain the database name; that is already configured in the connection manager.</li>
</ul>
<p><img alt="SQL statement task settings" src="../images/is-create-sql-connection.png" /></p>
</li>
<li>
<p>Add a new <em>Data flow</em> element to the control flow pane. Give a meaningful name to this task: "import users." This task should follow the previous cleanup task: draw a line from the previous task box to this one to specify the ordering.</p>
<p>Your control flow should like the following at this moment.</p>
<p><img alt="Integration Services Control Flow for importing users" src="../images/is-users-control-flow.png" /></p>
</li>
<li>
<p>Open the data flow element by double-clicking it.</p>
</li>
<li>
<p>Drag a <em>Flat file source</em> from the toolbox to the data flow pane. Double click to open in. Add a new <em>Flat file connection manager</em> that specifies the source file and its details.</p>
<ul>
<li>Browse the input file <code>BX-Users.csv</code> from your local disk.</li>
<li>
<p>Set the correct <em>Format</em> for parsing</p>
<ul>
<li>Format: Delimited</li>
<li>Text qualifier: specify " (double quotation mark)</li>
<li>Check "Column names in the first data row"</li>
</ul>
<p><img alt="Integration Services flat file source settings" src="../images/is-users-flat-file-conn.png" /></p>
</li>
<li>
<p>Switch to the <em>Columns</em> page (within the dialog)</p>
<ul>
<li>Verify that the <em>Row delimiter</em> is <code>{CR}{LF}</code>, and the <em>Column delimiter</em> is a semicolon.</li>
</ul>
</li>
<li>Switch to the <em>Advanced</em> page (within the dialog)<ul>
<li>Verify that the correct number of columns is present</li>
<li>Change the UserID to be parsed as <code>four byte signed integer</code></li>
<li>Although the age should be a number, it must be parsed as a string because there are values in the CSV with the literal <code>NULL</code> text</li>
<li>Increase the length (<em>OutputColumnWidth</em>) of the Location column from 50 to 1.000</li>
</ul>
</li>
<li>The preview pane is a good way to verify the results. Ensure that there are no lingering quotation marks in the values (if there are, you missed to specify the text qualifier before).</li>
<li>
<p>Close the dialog. If you need to modify the settings, you will find this <em>Connection manager</em> at the bottom of the designer surface.</p>
<p><img alt="Integration Services connection managers" src="../images/is-connection-managers.png" /></p>
</li>
</ul>
</li>
<li>
<p>To split the <em>Location</em> column into two and parse the <em>Age</em> as a number, add a <em>Derived column</em> transformation (drag one from the SSIS Toolbox pane to the data flow editor surface). Connect the blue output of the file source into this new box to specify the data flow direction (see image below for reference). Then open the settings of the <em>Derived column</em> element to specify how the derived values are calculated.</p>
<ul>
<li>Add a new column that contains the age as an integer. Check if the string is "NULL"; in that case, keep the null value, or cast to int.<ul>
<li>Use the following expression: <code>[Age] == "NULL" ? NULL(DT_I4) : (DT_I4)[Age]</code>. (You may need to change the column names.)</li>
</ul>
</li>
<li>Split the location column into two, and <strong>include your Neptun code</strong> in the text: create a new <em>City</em>, and a new <em>Country</em> column using string operations; <em>Country</em> should be prefixed with your Neptun code.<ul>
<li>Take a look at a few examples of the <em>Location</em>: they are in the form of "city, state, country"</li>
<li>To separate the country, find the second comma in the text. The rest is the city (you can keep the state included in the city text). <strong>Prefix the country with your Neptun code</strong> by concatenating it as a string to the front. E.g., "nyc, new york, usa" becomes:<ul>
<li>Country: "NEPTUN usa"</li>
<li>City: "nyc, new york"</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Find more information on the syntax of the <em>Expression</em> here: <a href="https://docs.microsoft.com/en-us/sql/integration-services/expressions/integration-services-ssis-expressions?view=sql-server-2017)">https://docs.microsoft.com/en-us/sql/integration-services/expressions/integration-services-ssis-expressions?view=sql-server-2017)</a></p>
<p><img alt="Integration Services Derived column transformation" src="../images/is-users-derived-col.png" /></p>
</li>
</ul>
</li>
<li>
<p>Remove duplicate records. Add a new <em>Sort</em> transformation, then connect it to the output of the previous element. Open its settings: chose to sort on the <em>UserID</em>, and check the <em>Remove rows with duplicate sort values</em> checkbox.</p>
<p><img alt="Integration Services duplicate filtering" src="../images/is-users-sorting.png" /></p>
</li>
<li>
<p>Add an <em>ADO NET Destination</em> component (look in the <em>Other Destinations</em> category) to save the data into the database.</p>
<ul>
<li>Direct the output of the previous <em>Sort</em> component here.</li>
<li>Open the component settings dialog by double-clicking the component box.</li>
<li>Use the connection manager created before. (Make sure <em>not</em> to create a new connection manager - the database access has already been defined in the existing connection manager.)</li>
<li>
<p>Select the users table you created as the target.</p>
<p><img alt="Integration Services ADO NET Destination settings" src="../images/is-users-adonet-destination.png" /></p>
</li>
<li>
<p>Check the mapping and make sure that the correct fields go into the correct columns. Make sure to double-check the <em>Age</em> column because it may exist as a number and as a string - you need the numbered type here. (Mind that the input column names may be different for you.)</p>
<p><img alt="Integration Services ADO NET Destination mapping" src="../images/is-users-adonet-mapping.png" /></p>
</li>
</ul>
</li>
<li>
<p>If you were to execute the process now, it would fail due to errors in the <em>Derived columns</em> transformation. Some content fails the transformations. Let us skip these rows.</p>
<ul>
<li>Add another <em>ADO NET Destination</em> component.</li>
<li>
<p>Point the red arrow from the <em>Derived column</em> into this new database destination.</p>
<p><img alt="Integration Services Data flow of the Users import" src="../images/is-users-data-flow.png" /></p>
</li>
<li>
<p>A the <a href="https://docs.microsoft.com/en-us/sql/integration-services/configure-an-error-output-in-a-data-flow-component">Configure Error Output dialog</a> will pop up to specify how to handle errors. For all columns and error types, select <em>Redirect row</em>. There is a total number of 6 elements to change here. Close this dialog.</p>
<p><img alt="Integration Services Error output configuration" src="../images/is-users-error-output.png" /></p>
</li>
<li>
<p>Open the new <em>ADO NET Destination</em> and specify its settings too.</p>
<ul>
<li>Although the result of the transformations is not available, we still save the UserId value. The other database columns will not have any mapping. So effectively, only the UserID will be saved to the database.</li>
<li>Use the connection manager created before. (Make sure <em>not</em> to create a new connection manager - the database access has already been defined in the existing connection manager.)</li>
</ul>
<p><img alt="Integration Services database output mapping for transformation errors" src="../images/is-users-adonet-mapping-for-errors.png" /></p>
</li>
</ul>
</li>
<li>
<p>Run the ETL process by using the <em>Start</em> button on the toolbar of Visual Studio.</p>
<p>Verify that the execution succeeded. If not, see <a href="../bi-software-intro/">this guide</a> for debugging and resolving typical issues.</p>
</li>
<li>
<p>If the process succeeded, verify the <strong>contents of the table</strong> using SQL Server Management Studio. Verify that you <strong>added your Neptun code prefix</strong> to the Country names.</p>
<p>There will be a few rows with <code>NULL</code> values; these records failed the <em>Derived column</em> transformation. Check whether the failure was justified (the problem is with the input), or whether the error is in your ETL process!</p>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">SUBMISSION</p>
<p>Create a screenshot of the database table contents. Save the screenshot file as <code>ex3.png</code> - overwrite the placeholder file with yours.</p>
<p>Please make sure to create the screenshot such that it includes the database name (which is your Neptun code) from the <em>Object explorer</em> window, and includes a few sample records with the Neptun code clearly visible.</p>
<p><img alt="Sample expected screenshot" src="../images/users-table-verify-content.png" /></p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../exercise2/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Exercise 2: Create database and table for users data" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Exercise 2: Create database and table for users data
            </div>
          </div>
        </a>
      
      
        
        <a href="../exercise4/" class="md-footer__link md-footer__link--next" aria-label="Next: Exercise 4: Report about users" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Exercise 4: Report about users
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; BME VIK AUT
          </div>
        
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>